<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>رفع منشور - Menegram</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
body { margin:0; font-family: Arial, sans-serif; background:#fff; display:flex; justify-content:center; align-items:flex-start; padding-top:50px; }
.container { width:90%; max-width:500px; background:#f5f5f5; border-radius:10px; padding:15px; box-shadow:0 2px 10px rgba(0,0,0,0.2); }
h2 { text-align:center; margin-bottom:15px; }
.upload-preview { width:100%; margin-bottom:10px; display:flex; justify-content:center; align-items:center; overflow:hidden; border:1px solid #ccc; border-radius:10px; height:300px; background:#eee; position:relative; }
.upload-preview img, .upload-preview video { max-width:100%; max-height:100%; }
input[type="file"] { display:none; }
label.upload-btn { display:block; text-align:center; background:#8e44ad; color:#fff; padding:10px 20px; border-radius:20px; cursor:pointer; margin-bottom:10px; transition: transform 0.2s; }
label.upload-btn:active { transform: scale(1.1); }
textarea { width:100%; padding:10px; border-radius:10px; border:1px solid #ccc; resize:none; margin-bottom:10px; }
button.submit-btn { width:100%; padding:10px; border:none; border-radius:20px; background:#8e44ad; color:#fff; font-size:1em; cursor:pointer; transition: transform 0.2s; }
button.submit-btn:active { transform: scale(1.05); }
.audio-controls { margin-bottom:10px; }
</style>
</head>
<body>

<div class="container">
  <h2>رفع منشور جديد</h2>

  <div class="upload-preview" id="previewContainer">
    <span>معاينة المنشور هنا</span>
  </div>

  <label for="postUpload" class="upload-btn"><i class="fa-solid fa-upload"></i> اختر صورة أو فيديو</label>
  <input type="file" id="postUpload" accept="image/*,video/*">

  <label for="audioUpload" class="upload-btn"><i class="fa-solid fa-music"></i> اختر ملف صوتي (اختياري)</label>
  <input type="file" id="audioUpload" accept="audio/*">

  <div class="audio-controls" id="audioControls" style="display:none;">
    <audio controls id="audioPreview"></audio>
  </div>

  <textarea id="postCaption" rows="3" placeholder="اكتب وصف للمنشور..."></textarea>
  <button class="submit-btn" onclick="submitPost()">رفع المنشور</button>
</div>

<script>
const previewContainer = document.getElementById('previewContainer');
const postUpload = document.getElementById('postUpload');
const audioUpload = document.getElementById('audioUpload');
const audioControls = document.getElementById('audioControls');
const audioPreview = document.getElementById('audioPreview');

let videoElement = null;

// معاينة الصورة أو الفيديو
postUpload.addEventListener('change', function(e){
  const file = e.target.files[0];
  if(!file) return;
  const url = URL.createObjectURL(file);
  previewContainer.innerHTML = '';
  if(file.type.startsWith('image')){
    videoElement = null;
    const img = document.createElement('img');
    img.src = url;
    previewContainer.appendChild(img);
  } else if(file.type.startsWith('video')){
    videoElement = document.createElement('video');
    videoElement.src = url;
    videoElement.controls = true;
    videoElement.autoplay = true;
    videoElement.loop = true;
    previewContainer.appendChild(videoElement);
  }
});

// معاينة الصوت
audioUpload.addEventListener('change', function(e){
  const file = e.target.files[0];
  if(!file) return;
  const url = URL.createObjectURL(file);
  audioPreview.src = url;
  audioControls.style.display = 'block';
  audioPreview.play();
});

// رفع المنشور
function submitPost(){
  const caption = document.getElementById('postCaption').value.trim();
  if(!postUpload.files[0]){
    alert('اختر صورة أو فيديو أولاً');
    return;
  }
  let fileType = postUpload.files[0].type.startsWith('video') ? 'فيديو' : 'صورة';
  alert(`تم رفع المنشور بنجاح!\nنوع الملف: ${fileType}\nالوصف: ${caption}`);
  
  // إعادة ضبط المعاينة
  previewContainer.innerHTML = '<span>معاينة المنشور هنا</span>';
  postUpload.value = '';
  audioUpload.value = '';
  audioControls.style.display = 'none';
  audioPreview.src = '';
  document.getElementById('postCaption').value = '';
}
</script>

</body>
</html>